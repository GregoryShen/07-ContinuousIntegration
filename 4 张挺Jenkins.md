## 17 Jenkins 持续集成

### 17.1 Jenkins 持续集成的简介

#### 持续集成与自动化测试的关系

随着软件技术的不断发展，集成的频率也越来越快，在瀑布模型的年代，只有一个软件进入测试阶段才会开始做集成。而现在，每天集成多次也完全可能。这一切依赖于自动化的持续集成工具。值得注意的是，自动化在持续集成中是必须的，在持续集成系统上自动化构建软件，其步骤包括编译，自动化单元测试，自动化集成测试，代码扫描，发布，部署等环节。其中每个环节步骤又有很多工具和脚本。这些工具和脚本往往和自动化测试密切相关，因此测试人员需要掌握这些。

自动化测试在持续集成中至关重要。任何未经过测试的版本，即使构建出来，也是无用的版本。而为了快速迭代，快速发布软件的新版本，测试必须是自动化的。诚然，自动化测试不能完全替代手工测试，但是，它正在替代大多数手工测试。其原因在于，自动化测试的超高效率，以及它和持续集成的紧密配合。当持续集成刚刚出现，每天集成一个新版本的时候，手工测试还能跟得上节奏，然而随着技术发展，每天集成几个新版本甚至十几个新版本时，只有自动化测试能跟得上持续集成的节奏。

要实现持续集成，需要使用很多工具，但其中最重要的工具则是持续集成系统。Jenkins在第一次使用的时候就要开始理解他的设计原理： Jenkins通过提供Web界面，让用户可以简单地组分布式来执行各种任务（这些任务被称为Job）

#### Jenkins 的简介

Jenkins的最核心功能是以分布式的形式运行我们预先设置好的任务。

首先，在没有持续集成，软件也都是单机软件的时候，我们要发布一个软件的新版本，可以在自己的个人电脑上直接编译源代码，然后打包成exe文件，并把这个exe文件拿去发布。后来，网络软件成了主流，我们的发布方式改成把源代码编译成软件包，然后发送到Web服务器上去完成部署。之后用户就可以访问这个Web服务器来使用

### 17.2 Jenkins 的安装

Jenkins 的下载主要是从官网 https://jenkins.io/download 或者镜像站 http://mirrors.jenkins-ci.org/ 下载。我下载的是war包，war包的使用比较简单，镜像站中的 `mirrors.jenkins-ci.org/war/latest/` 这个地址可以下载到 `jenkins.war` 这个war 包。 安装方面， war包是免安装的。我们只需要在命令行里打开存放这个包的路径，然后使用以下命令启动 jenkins：

```java
java -jar jenkins.war
```

然后，我们打开浏览器，输入地址 http://localhost:8080/ ，经过一番等待后，正常的话就会看到这个界面：

这里，我们按照提示，打开指定的文件，把管理员密码输进去，然后点击继续。 Jenkins这时应该跳转到下载插件的页面。

在这个页面上，选择“选择插件来安装”，然后在后续页面上选择“无”， 再点击下方安装按钮：

则可以不下载任何插件而完成Jenkins 的安装。我们可以在后面进入插件管理页面再进行安装和删除等管理操作。

而如果在Jenkins界面时网络连接失败（国内有些网络经常遇到这个现象），则会进入下面界面：

在这个页面上，我们选择“跳过插件安装”即可，也可以完成安装过程。后续仍然可以在插件管理页面进行插件下载安装，也可以后续通过手动安装等其他方式来安装插件。

然后就到了“创建第一个管理员用户”页面：

在这里，Jenkins要求我们创建第一个管理员用户，要求我们输入用户名 Username, Password。这里，我们可以依次这样输入：

Username: admin

Password: admin

Confirm password: admin

Full name: admin

点击保存并完成后进入实例配置页面，这里保持默认值不需要改变， 直接保存并继续。

然后点击开始使用Jenkins，进入Jenkins首页。

### 17.3 Jenkins 的插件配置和下载

从Jenkins 首页上，我们要关注这几个链接：中间最大的 create new jobs 是用来创建新的 job 的。左边的 New Item （中文版为“新建任务”） 也是起到同样的作用。 左边的 Manage Jenkins 里可以对Jenkins 做配置。我们第一次使用Jenkins的话，需要下载一些插件，点击页面左侧的 manage Jenkins，进入Jenkins 管理页面：

这个页面上显示的都是管理相关的功能，介绍如下：

* Configure System：系统配置，一些全局参数的设置
* Configure Global Security: 安全配置，定义谁可以用这个Jenkins
* Global Tool Configuration：全局工具配置，用于配置Maven，JDK之类的工具，这里的配置对整个Jenkins生效
* Reload Configuration from Disk：重置配置信息，以磁盘上存储的配置为准
* Manage Plugins：添加、删除、或者禁用、启用插件，这个功能是最常用的
* 

































### 17.4 Jenkins 上创建和运行job



### 17.5 Jenkins 上运行接口测试